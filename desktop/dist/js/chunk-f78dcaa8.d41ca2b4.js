(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-f78dcaa8"],{1148:function(t,e,a){"use strict";var o=a("a691"),i=a("1d80");t.exports="".repeat||function(t){var e=String(i(this)),a="",n=o(t);if(n<0||n==1/0)throw RangeError("Wrong number of repetitions");for(;n>0;(n>>>=1)&&(e+=e))1&n&&(a+=e);return a}},"26e9":function(t,e,a){"use strict";var o=a("23e7"),i=a("e8b5"),n=[].reverse,r=[1,2];o({target:"Array",proto:!0,forced:String(r)===String(r.reverse())},{reverse:function(){return i(this)&&(this.length=this.length),n.call(this)}})},"408a":function(t,e,a){var o=a("c6b6");t.exports=function(t){if("number"!=typeof t&&"Number"!=o(t))throw TypeError("Incorrect invocation");return+t}},5959:function(t,e,a){"use strict";a.r(e);var o=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",[a("div",{staticClass:"mainContent"},[a("div",{staticClass:"head"},[a("span",{staticStyle:{"font-size":"22px",color:"#FFF"}},[t._v("房间总览")]),a("div",{staticClass:"attach"},[a("Select",{attrs:{size:"small"},model:{value:t.countType,callback:function(e){t.countType=e},expression:"countType"}},[a("Option",{attrs:{value:"0"}},[t._v("按部门统计")]),a("Option",{attrs:{value:"1"}},[t._v("按用途统计")])],1)],1)]),a("div",{staticClass:"body"},[a("div",{staticClass:"blockTitle"},[t._v(" 房间统计 ")]),a("div",{staticClass:"info"},[a("div",{staticClass:"roomInfo"},[a("div",{staticClass:"baseInfo"},[a("div",[t._v("房间数")]),a("div",[a("span",{staticStyle:{"font-size":"20px"}},[t._v(t._s(t.roomCount))]),t._v(" 个")])])]),a("div",{staticClass:"roomInfo"},[a("div",{staticClass:"baseInfo"},[a("div",[t._v("使用部门")]),a("div",[a("span",{staticStyle:{"font-size":"20px"}},[t._v(t._s(t.departmentCount))]),t._v(" 个")])])]),a("div",{staticClass:"roomInfo"},[a("div",{staticClass:"baseInfo"},[a("div",[t._v("用途种类")]),a("div",{staticStyle:{"font-size":"20px"}},[t._v(t._s(t.usageCount)+" 个")])])]),a("div",{staticClass:"roomInfo"},[a("div",{staticClass:"baseInfo",staticStyle:{cursor:"pointer"},on:{click:function(e){t.showDetail=!t.showDetail}}},[t._v(" "+t._s(t.showDetail?"显示总览":"显示详情")+" ")])])]),a("div",{staticClass:"table",class:{roomDetail:t.showDetail}},[t.showDetail?[t.roomLoading?a("Loading"):[a("table",[a("thead",[a("tr",[a("th",[t._v("房间号")]),a("th",[t._v("房间名称")]),a("th",[t._v("部门")]),a("th",[t._v("用途")]),a("th",[t._v("使用状态")]),a("th",[t._v("使用面积（㎡）")])])])]),a("div",{staticClass:"tableDetail"},[a("table",t._l(t.roomDetail,(function(e){return a("tr",{key:e.name},[a("td",[t._v(t._s(e.name))]),a("td",[t._v(t._s(e.count))]),a("td",[t._v(t._s(e.areaUse))]),a("td",[t._v(t._s(e.buildUse))])])})),0)])]]:[t._m(0),a("div",{staticClass:"tableDetail"},[a("table",t._l(t.tableValue,(function(e){return a("tr",{key:e.name},[a("td",[t._v(t._s(e.name))]),a("td",[t._v(t._s(e.count))]),a("td",[t._v(t._s(e.areaUse))]),a("td",[t._v(t._s(e.buildUse))])])})),0)])]],2),a("div",{staticClass:"blockTitle"},[t._v(" 运维统计 ")]),a("div",{staticClass:"info"},[a("div",{staticClass:"roomInfo"},[a("div",{staticClass:"baseInfo widthAttach"},[a("div",[t._v(t._s(t.repairRoom))]),a("div",{staticStyle:{"border-left":"1px solid #FFF","margin-left":"6px","padding-left":"6px"}},[t._v("异常率 "+t._s(t._f("getPresent")(t.repairRoom,t.roomCount))+"% ")])]),a("div",{staticClass:"attach"},[t._v(" 报修房间 ")])]),a("div",{staticClass:"roomInfo"},[a("div",{staticClass:"baseInfo widthAttach"},[a("div",[t._v(t._s(t.maintenanceCount))]),a("div",{staticStyle:{"border-left":"1px solid #FFF","margin-left":"6px","padding-left":"6px"}},[t._v("异常率 "+t._s(t._f("getPresent")(t.maintenanceCount,t.roomCount))+"% ")])]),a("div",{staticClass:"attach"},[t._v(" 维保房间 ")])]),a("div",{staticClass:"roomInfo"},[a("div",{staticClass:"baseInfo widthAttach"},[a("div",[t._v(t._s(t.unusedRoomCount))]),a("div",{staticStyle:{"border-left":"1px solid #FFF","margin-left":"6px","padding-left":"6px"}},[t._v("闲置率 "+t._s(t._f("getPresent")(t.unusedRoomCount,t.roomCount))+"% ")])]),a("div",{staticClass:"attach"},[t._v(" 闲置房间 ")])])]),a("div",{staticClass:"blockTitle"},[t._v(" 房间面积统计 ")]),t._m(1),a("div",{staticClass:"charts"},[a("div",{staticClass:"chart",attrs:{id:t.chartIdA}}),a("div",{staticClass:"chart",attrs:{id:t.chartIdB}})])])]),a("FloorSelector",{staticStyle:{position:"absolute",left:"80px",bottom:"20px","pointer-events":"all"},attrs:{dataset:t.floors}})],1)},i=[function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("table",[a("thead",[a("tr",[a("th",[t._v("名称")]),a("th",[t._v("房间数")]),a("th",[t._v("实际使用面积(㎡)")]),a("th",[t._v("建筑总面积(㎡)")])])])])},function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",{staticClass:"clearfix",staticStyle:{"text-align":"center",color:"#FFF","font-size":"18px"}},[a("div",{staticStyle:{width:"50%",float:"left"}},[t._v("用途面积占比")]),a("div",{staticStyle:{width:"50%",float:"left"}},[t._v("部门面积占比")])])}],n=(a("4160"),a("d81d"),a("26e9"),a("b0c0"),a("b680"),a("e25e"),a("159b"),a("4dc6")),r=a("5f81"),s=a("9f12"),c=a("53fe"),l=a("8b83"),u=a("c65a"),d=a("c03e"),f=a("9ab4"),v=a("60a3"),h=a("240a"),p=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",{staticStyle:{width:"80px",overflow:"visible","pointer-events":"all"}},[t._l(t.currentDataset,(function(e){return a("div",{key:e.id,staticClass:"floor",class:{active:e.active},on:{click:function(a){return t.setActive(e.id)}}},[a("div",{staticClass:"colorBar"}),a("div",{staticClass:"info"},[t._v(" "+t._s(e.name)+" ")])])})),a("div",{staticClass:"allFloor",class:{active:t.showAllFloor},on:{click:t.showAll}},[t._v(" 全部楼层 ")])],2)},b=[],m=(a("a4d3"),a("4de4"),a("7db0"),a("e439"),a("dbb4"),a("b64b"),a("2fa7"));function _(t,e){var a=Object.keys(t);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(t);e&&(o=o.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),a.push.apply(a,o)}return a}function C(t){for(var e=1;e<arguments.length;e++){var a=null!=arguments[e]?arguments[e]:{};e%2?_(Object(a),!0).forEach((function(e){Object(m["a"])(t,e,a[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(a)):_(Object(a)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(a,e))}))}return t}var g=function(t){function e(){var t;return Object(s["a"])(this,e),t=Object(l["a"])(this,Object(u["a"])(e).apply(this,arguments)),t.currentDataset=t.dataset.map((function(t){return C({},t,{active:!1})})),t.showAllFloor=!0,t}return Object(d["a"])(e,t),Object(c["a"])(e,[{key:"setActive",value:function(t){var e=this.currentDataset.find((function(t){return t.active}));e&&(e.active=!1);var a=this.currentDataset.find((function(e){return e.id===t}));if(this.$store.commit("changeViewByCode",{type:"room",id:t}),!a)throw new Error("no specific data find");a.active=!0}},{key:"showAll",value:function(){this.currentDataset.forEach((function(t){t.active=!1})),this.showAllFloor=!0,this.$store.commit("changeViewByCode",{type:"room",id:""})}},{key:"mounted",value:function(){this.$store.commit("changeViewByCode",{type:"room",id:""})}},{key:"onDatasetChange",value:function(t){this.$store.commit("changeViewByCode",{type:"room",id:""}),this.currentDataset=t.map((function(t){return C({},t,{active:!1})}))}}]),e}(v["c"]);f["a"]([Object(v["b"])()],g.prototype,"dataset",void 0),f["a"]([Object(v["d"])("dataset")],g.prototype,"onDatasetChange",null),g=f["a"]([v["a"]],g);var y=g,w=y,O=(a("9aba"),a("2877")),x=Object(O["a"])(w,p,b,!1,null,"41b92338",null),S=x.exports,F=a("7f1a"),j=a.n(F),k=a("c154"),I=function(t){function e(){var t;return Object(s["a"])(this,e),t=Object(l["a"])(this,Object(u["a"])(e).apply(this,arguments)),t.floors=[],t.countType="0",t.showDetail=!1,t.roomCount=0,t.usageCount=0,t.departmentCount=0,t.repairRoom=0,t.maintenanceCount=0,t.tableSource={usage:[],department:[]},t.roomDetail=[],t.roomLoading=!0,t.chartIdA="id"+parseInt(100*Math.random()+"1"),t.chartIdB="id"+parseInt(100*Math.random()+"1"),t.subscribe=t.$store.subscribe((function(e,a){"changeViewByCode"===e.type&&t.getCount()})),t}return Object(d["a"])(e,t),Object(c["a"])(e,[{key:"getCount",value:function(){var t=this,e=this.$store.state.modelValue,a=Object(h["a"])({url:"/space/room/",params:{floor:e,pagesize:1}});a.then((function(e){var a=e.data;t.roomCount=a.count})),Object(h["a"])({url:"/space/room/roominfo/",params:{floor:e}}).then((function(e){var o=e.data,i=o["用途"],n=o["部门"];t.departmentCount=n.length,t.usageCount=i.length,t.tableSource.department=n.map((function(t){return{name:t.department__name,count:t.id__count,areaUse:t.NetArea__sum,buildUse:t.GrossArea__sum}})),t.tableSource.usage=i.map((function(t){return{name:t.category__name,count:t.id__count,areaUse:t.NetArea__sum,buildUse:t.GrossArea__sum}})),a.then((function(){var e=t.roomCount;[t.chartA,t.chartB].forEach((function(a,o){void 0!==a&&(a.source(t.tableSource[["usage","department"][o]]),a.coord("theta"),a.tooltip({showTitle:!1}),a.legend({textStyle:{fill:"#FFF"}}),a.intervalStack().position("count").color("name").label("count",(function(t){return t/e<.05?null:{offset:-40,textStyle:{textAlign:"center",shadowBlur:2,shadowColor:"rgba(0, 0, 0, .45)",fill:"#fff"}}})).style({lineWidth:1,stroke:"#fff"}),a.render())}))}))})),Object(h["a"])({url:"/repair/rest/projecteventelement/unityinfo/",params:{t:"房间",floor:e}}).then((function(e){var a=e.data;a=a.data,t.maintenanceCount=a["维保"].length,t.repairRoom=a["维修"].length}))}},{key:"mounted",value:function(){var t=this;Object(h["a"])({url:"/space/floor/",params:{facility:1}}).then((function(e){var a=e.data;t.floors=a.reverse().map((function(t){return{name:t.name,id:t.id}}))})),this.chartA=new j.a.Chart({container:this.chartIdA,forceFit:!0,height:300}),this.chartB=new j.a.Chart({container:this.chartIdB,forceFit:!0,height:300}),this.getCount()}},{key:"beforeRouteLeave",value:function(t,e,a){this.subscribe(),a()}},{key:"tableValue",get:function(){return"0"===this.countType?this.tableSource.department:this.tableSource.usage}},{key:"unusedRoomCount",get:function(){var t=0;return this.tableSource.usage.forEach((function(e){t+=e.count})),this.roomCount-t}}]),e}(v["c"]);I=f["a"]([Object(v["a"])({components:{Select:r["a"],Option:n["a"],FloorSelector:S,Loading:k["a"]},filters:{getPresent:function(t,e){return 0===e?"0.00":(t/e*100).toFixed(2)}}})],I);var D=I,A=D,E=(a("6188"),Object(O["a"])(A,o,i,!1,null,null,null));e["default"]=E.exports},6188:function(t,e,a){"use strict";var o=a("b1cd"),i=a.n(o);i.a},"9aba":function(t,e,a){"use strict";var o=a("c778"),i=a.n(o);i.a},b1cd:function(t,e,a){},b680:function(t,e,a){"use strict";var o=a("23e7"),i=a("a691"),n=a("408a"),r=a("1148"),s=a("d039"),c=1..toFixed,l=Math.floor,u=function(t,e,a){return 0===e?a:e%2===1?u(t,e-1,a*t):u(t*t,e/2,a)},d=function(t){var e=0,a=t;while(a>=4096)e+=12,a/=4096;while(a>=2)e+=1,a/=2;return e},f=c&&("0.000"!==8e-5.toFixed(3)||"1"!==.9.toFixed(0)||"1.25"!==1.255.toFixed(2)||"1000000000000000128"!==(0xde0b6b3a7640080).toFixed(0))||!s((function(){c.call({})}));o({target:"Number",proto:!0,forced:f},{toFixed:function(t){var e,a,o,s,c=n(this),f=i(t),v=[0,0,0,0,0,0],h="",p="0",b=function(t,e){var a=-1,o=e;while(++a<6)o+=t*v[a],v[a]=o%1e7,o=l(o/1e7)},m=function(t){var e=6,a=0;while(--e>=0)a+=v[e],v[e]=l(a/t),a=a%t*1e7},_=function(){var t=6,e="";while(--t>=0)if(""!==e||0===t||0!==v[t]){var a=String(v[t]);e=""===e?a:e+r.call("0",7-a.length)+a}return e};if(f<0||f>20)throw RangeError("Incorrect fraction digits");if(c!=c)return"NaN";if(c<=-1e21||c>=1e21)return String(c);if(c<0&&(h="-",c=-c),c>1e-21)if(e=d(c*u(2,69,1))-69,a=e<0?c*u(2,-e,1):c/u(2,e,1),a*=4503599627370496,e=52-e,e>0){b(0,a),o=f;while(o>=7)b(1e7,0),o-=7;b(u(10,o,1),0),o=e-1;while(o>=23)m(1<<23),o-=23;m(1<<o),b(1,1),m(2),p=_()}else b(0,a),b(1<<-e,0),p=_()+r.call("0",f);return f>0?(s=p.length,p=h+(s<=f?"0."+r.call("0",f-s)+p:p.slice(0,s-f)+"."+p.slice(s-f))):p=h+p,p}})},c778:function(t,e,a){}}]);
//# sourceMappingURL=chunk-f78dcaa8.d41ca2b4.js.map